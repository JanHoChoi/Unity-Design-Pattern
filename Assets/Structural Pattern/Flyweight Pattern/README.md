# Flyweight Pattern 享元模式

## Usage 用途

如果在使用枚举类型的时候，经常需要对实例进行switch判断类型，而且使用时候不依赖上下文状态。此时可以用享元模式取代。直接创建若干个枚举类型的单一实例，数据则单纯引用这些单一实例。

当一个类有很多实例，而这些实例可以被同一个方法控制（所以即与上下文状态无关），不妨使用享元模式，然而这些单个实例无法拥有独立不同的行为。

## Definition 定义

可以支持用共享对象表示大量的重复的对象。

![flyweight](https://github.com/JanHoChoi/Unity-Design-Pattern/blob/master/Pictures/flyweight.gif)

## Element 要素

### Flyweight 享元

定义了享元的基类。

### ConcreteFlyweight 享元子类

继承了Flyweight或者使用了Flyweight接口，并且存储了决定Flyweight的外部变量。

### FlyweightFactory 享元工厂

工厂用于生成和管理享元对象。保证当需要用到享元时，工厂可以提供一个已有的享元或者新建一个未存在的享元。

### Client 客户

持有对享元的引用。用于计算享元的一些外部变量。

## Extension 引申

### 优点

- 减少实例个数
- 将许多对象状态集中起来管理

### 缺点

- 实例无法拥有单独的行为。

### 结构封装

因为享元模式需要共享某些对象，所以最好做一个工厂，从工厂中取对象，如果没有对象，则初始化，有对象则返回已有对象的引用。

### 对象池模式

可以用对象池模式存储实例化出来的享元。

### 状态机模式

状态机模式的不同状态的实例可以重复使用，所以只需要初始化一个。